<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>12.2. Zend\Dom\Query</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="prev" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="next" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
<link rel="subsection" href="zend.dom.query.html#zend.dom.query.operation" title="12.2.1. Theory of Operation">
<link rel="subsection" href="zend.dom.query.html#zend.dom.query.methods" title="12.2.2. Methods Available">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">12.2. Zend\Dom\Query</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.dom.html">Prev</a> </td>
<th width="60%" align="center">Chapter 12. Zend\Dom</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.event-manager.html">Next</a>
</td>
</tr>
</table></div>
<div class="section" title="12.2. Zend\Dom\Query">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.dom.query"></a>12.2. Zend\Dom\Query</h2></div></div></div>
<p>
        <code class="classname">Zend\Dom\Query</code> provides mechanisms for querying
        <acronym class="acronym">XML</acronym> and (X)<acronym class="acronym">HTML</acronym> documents utilizing either XPath or
        <acronym class="acronym">CSS</acronym> selectors. It was developed to aid with functional testing of
        <acronym class="acronym">MVC</acronym> applications, but could also be used for rapid development of screen
        scrapers.
    </p>
<p>
        <acronym class="acronym">CSS</acronym> selector notation is provided as a simpler and more familiar
        notation for web developers to utilize when querying documents with <acronym class="acronym">XML</acronym>
        structures. The notation should be familiar to anybody who has developed
        Cascading Style Sheets or who utilizes Javascript toolkits that provide
        functionality for selecting nodes utilizing <acronym class="acronym">CSS</acronym> selectors
        (<a class="link" href="http://prototypejs.org/api/utility/dollar-dollar" target="_top">Prototype's
            $$()</a> and
        <a class="link" href="http://api.dojotoolkit.org/jsdoc/dojo/HEAD/dojo.query" target="_top">Dojo's
            dojo.query</a> were both inspirations for the component).
    </p>
<div class="section" title="12.2.1. Theory of Operation">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.dom.query.operation"></a>12.2.1. Theory of Operation</h3></div></div></div>
<p>
            To use <code class="classname">Zend\Dom\Query</code>, you instantiate a
            <code class="classname">Zend\Dom\Query</code> object, optionally passing a document to
            query (a string). Once you have a document, you can use either the
            <code class="methodname">query()</code> or <code class="methodname">queryXpath()</code> methods; each
            method will return a <code class="classname">Zend\Dom\NodeList</code> object with
            any matching nodes.
        </p>
<p>
            The primary difference between <code class="classname">Zend\Dom\Query</code> and using
            <a class="link" href="http://php.net/domnodelist" target="_top">DOMDocument</a>
            + <a class="link" href="http://php.net/domxpath" target="_top">DOMXPath</a> is the ability to select against <acronym class="acronym">CSS</acronym>
            selectors. You can utilize any of the following, in any combination:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                    <span class="emphasis"><em>element types</em></span>: provide an element type to
                    match: 'div', 'a', 'span', 'h2', etc.
                </p></li>
<li class="listitem"><p>
                    <span class="emphasis"><em>style attributes</em></span>: <acronym class="acronym">CSS</acronym> style attributes
                    to match: '<span class="command"><strong>.error</strong></span>', '<span class="command"><strong>div.error</strong></span>',
                    '<span class="command"><strong>label.required</strong></span>', etc. If an
                    element defines more than one style, this will match as long as
                    the named style is present anywhere in the style declaration.
                </p></li>
<li class="listitem"><p>
                    <span class="emphasis"><em>id attributes</em></span>: element ID attributes to
                    match: '#content', 'div#nav', etc.
                </p></li>
<li class="listitem">
<p>
                    <span class="emphasis"><em>arbitrary attributes</em></span>: arbitrary element
                    attributes to match. Three different types of matching are
                    provided:
                </p>
<div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem"><p>
                            <span class="emphasis"><em>exact match</em></span>: the attribute exactly
                            matches the string: 'div[bar="baz"]' would match a div
                            element with a "bar" attribute that exactly matches the
                            value "baz".
                        </p></li>
<li class="listitem"><p>
                            <span class="emphasis"><em>word match</em></span>: the attribute contains
                            a word matching the string: 'div[bar~="baz"]' would match a div
                            element with a "bar" attribute that contains the
                            word "baz". '&lt;div bar="foo baz"&gt;' would match, but '&lt;div
                            bar="foo bazbat"&gt;' would not.
                        </p></li>
<li class="listitem"><p>
                            <span class="emphasis"><em>substring match</em></span>: the attribute contains
                            the string: 'div[bar*="baz"]' would match a div
                            element with a "bar" attribute that contains the
                            string "baz" anywhere within it.
                        </p></li>
</ul></div>
</li>
<li class="listitem"><p>
                    <span class="emphasis"><em>direct descendents</em></span>: utilize '&gt;' between
                    selectors to denote direct descendents. 'div &gt; span' would
                    select only 'span' elements that are direct descendents of a
                    'div'. Can also be used with any of the selectors above.
                </p></li>
<li class="listitem">
<p>
                    <span class="emphasis"><em>descendents</em></span>: string together
                    multiple selectors to indicate a hierarchy along which
                    to search. '<span class="command"><strong>div .foo span #one</strong></span>' would select an element
                    of id 'one' that is a descendent of arbitrary depth
                    beneath a 'span' element, which is in turn a descendent
                    of arbitrary depth beneath an element with a class of
                    'foo', that is an descendent of arbitrary depth beneath
                    a 'div' element. For example, it would match the link to
                    the word 'One' in the listing below:
                </p>
<pre class="programlisting">
&lt;div&gt;
&lt;table&gt;
    &lt;tr&gt;
        &lt;td class="foo"&gt;
            &lt;div&gt;
                Lorem ipsum &lt;span class="bar"&gt;
                    &lt;a href="/foo/bar" id="one"&gt;One&lt;/a&gt;
                    &lt;a href="/foo/baz" id="two"&gt;Two&lt;/a&gt;
                    &lt;a href="/foo/bat" id="three"&gt;Three&lt;/a&gt;
                    &lt;a href="/foo/bla" id="four"&gt;Four&lt;/a&gt;
                &lt;/span&gt;
            &lt;/div&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
</pre>
</li>
</ul></div>
<p>
            Once you've performed your query, you can then work with the result
            object to determine information about the nodes, as well as to pull
            them and/or their content directly for examination and manipulation.
            <code class="classname">Zend\Dom\NodeList</code> implements <code class="classname">Countable</code>
            and <code class="classname">Iterator</code>, and stores the results internally as
            a <a class="link" href="http://php.net/domdocument" target="_top">DOMDocument</a> 
            and <a class="link" href="http://php.net/domnodelist" target="_top">DOMNodeList</a>. 
            As an example, consider the following call, that selects against the <acronym class="acronym">HTML</acronym> above:
        </p>
<pre class="programlisting">
use Zend\Dom\Query;

$dom = new Query($html);
$results = $dom-&gt;query('.foo .bar a');

$count = count($results); // get number of matches: 4
foreach ($results as $result) {
    // $result is a DOMElement
}
</pre>
<p>
            <code class="classname">Zend\Dom\Query</code> also allows straight XPath queries
            utilizing the <code class="methodname">queryXpath()</code> method; you can pass any
            valid XPath query to this method, and it will return a
            <code class="classname">Zend\Dom\NodeList</code> object.
        </p>
</div>
<div class="section" title="12.2.2. Methods Available">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.dom.query.methods"></a>12.2.2. Methods Available</h3></div></div></div>
<p>
            The <code class="classname">Zend\Dom\Query</code> family of classes have the following
            methods available.
        </p>
<div class="section" title="12.2.2.1. Zend\Dom\Query">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.dom.query.methods.zenddomquery"></a>12.2.2.1. Zend\Dom\Query</h4></div></div></div>
<p>
                The following methods are available to
                <code class="classname">Zend\Dom\Query</code>:
            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                        <code class="methodname">setDocumentXml($document, $encoding = null)</code>: specify an
                        <acronym class="acronym">XML</acronym> string to query against.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">setDocumentXhtml($document, $encoding = null)</code>: specify an
                        <acronym class="acronym">XHTML</acronym> string to query against.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">setDocumentHtml($document, $encoding = null)</code>: specify an
                        <acronym class="acronym">HTML</acronym> string to query against.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">setDocument($document, $encoding = null)</code>: specify a
                        string to query against; <code class="classname">Zend\Dom\Query</code> will
                        then attempt to autodetect the document type.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">setEncoding($encoding)</code>: specify an encoding 
                        string to use. This encoding will be passed to 
                        <a class="link" href="http://php.net/domdocument.construct" target="_top">DOMDocument's constructor</a> if specified. 
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">getDocument()</code>: retrieve the original document
                        string provided to the object.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">getDocumentType()</code>: retrieve the document
                        type of the document provided to the object; will be one of
                        the <code class="constant">DOC_XML</code>, <code class="constant">DOC_XHTML</code>, or
                        <code class="constant">DOC_HTML</code> class constants.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">getEncoding()</code>: retrieves the specified encoding.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">execute($query)</code>: query the document using
                        <acronym class="acronym">CSS</acronym> selector notation.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">queryXpath($xPathQuery)</code>: query the document
                        using XPath notation.
                    </p></li>
</ul></div>
</div>
<div class="section" title="12.2.2.2. Zend\Dom\NodeList">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.dom.query.methods.zenddomnodelist"></a>12.2.2.2. Zend\Dom\NodeList</h4></div></div></div>
<p>
                As mentioned previously, <code class="classname">Zend\Dom\NodeList</code>
                implements both <code class="classname">Iterator</code> and
                <code class="classname">Countable</code>, and as such can be used in a
                <code class="methodname">foreach()</code> loop as well as with the
                <code class="methodname">count()</code> function. Additionally, it exposes the
                following methods:
            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                        <code class="methodname">getCssQuery()</code>: return the <acronym class="acronym">CSS</acronym>
                        selector query used to produce the result (if any).
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">getXpathQuery()</code>: return the XPath query
                        used to produce the result. Internally,
                        <code class="classname">Zend\Dom\Query</code> converts <acronym class="acronym">CSS</acronym>
                        selector queries to XPath, so this value will always be populated.
                    </p></li>
<li class="listitem"><p>
                        <code class="methodname">getDocument()</code>: retrieve the DOMDocument the
                        selection was made against.
                    </p></li>
</ul></div>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.dom.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.dom.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.event-manager.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 12. Zend\Dom </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 13. Zend\EventManager</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
