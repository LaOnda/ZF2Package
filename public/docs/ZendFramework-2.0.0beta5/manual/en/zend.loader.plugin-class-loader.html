<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>19.2. The PluginClassLoader</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="prev" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="next" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
<link rel="subsection" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.intro" title="19.2.1. Overview">
<link rel="subsection" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.quick-start" title="19.2.2. Quick Start">
<link rel="subsection" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.options" title="19.2.3. Configuration Options">
<link rel="subsection" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.methods" title="19.2.4. Available Methods">
<link rel="subsection" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.examples" title="19.2.5. Examples">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">19.2. The PluginClassLoader</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html">Prev</a> </td>
<th width="60%" align="center">Chapter 19. Zend\Loader</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.loader.plugin-class-loader.methods.constructor.html">Next</a>
</td>
</tr>
</table></div>
<div class="section" title="19.2. The PluginClassLoader">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.loader.plugin-class-loader"></a>19.2. The PluginClassLoader</h2></div></div></div>
<div class="section" title="19.2.1. Overview">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.loader.plugin-class-loader.intro"></a>19.2.1. Overview</h3></div></div></div>
<p>
            Resolving plugin names to class names is a common requirement within Zend Framework
            applications. The <code class="classname">PluginClassLoader</code> implements the interfaces
            <a class="link" href="zend.loader.plugin-class-locator.html" title="19.4. The PluginClassLocator interface">PluginClassLocator</a>, <a class="link" href="zend.loader.short-name-locator.html" title="19.3. The ShortNameLocator Interface">ShortNameLocator</a>, and
            <code class="interfacename">IteratorAggregate</code>, providing a simple mechanism for aliasing
            plugin names to classnames for later retrieval.
        </p>
<p>
            While it can act as a standalone class, it is intended that developers will extend the
            class to provide a per-component plugin map. This allows seeding the map with the most
            often-used plugins, while simultaneously allowing the end-user to overwrite existing or
            register new plugins.
        </p>
<p>
            Additionally, <code class="classname">PluginClassLoader</code> provides the ability to
            statically seed all new instances of a given <code class="classname">PluginClassLoader</code> or
            one of its extensions (via Late Static Binding). If your application will always call
            for defining or overriding particular plugin maps on given
            <code class="classname">PluginClassLoader</code> extensions, this is a powerful capability.
        </p>
</div>
<div class="section" title="19.2.2. Quick Start">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.loader.plugin-class-loader.quick-start"></a>19.2.2. Quick Start</h3></div></div></div>
<p>
            Typical use cases involve simply instantiating a
            <code class="classname">PluginClassLoader</code>, seeding it with one or more plugin/class name
            associations, and then using it to retrieve the class name associated with a given
            plugin name.
        </p>
<pre class="programlisting">
use Zend\View\HelperLoader;

// Provide a global map, or override defaults:
HelperLoader::addStaticMap(array(
    'url' =&gt; 'My\Custom\UrlHelper',
));

// Instantiate the loader:
$loader = new Zend\View\HelperLoader();

// Register a new plugin:
$loader-&gt;registerPlugin('bugUrl', 'My\Custom\BugUrlHelper');

// Load/retrieve the associated plugin class:
$class = $loader-&gt;load('url'); // 'My\Custom\UrlHelper'
</pre>
<div class="note" title="Case Sensitivity"><table border="0" summary="Note: Case Sensitivity">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Case Sensitivity</th>
</tr>
<tr><td align="left" valign="top"><p>
                The <code class="classname">PluginClassLoader</code> is designed to do case-insensitive
                plugin name lookups. While the above example defines a "bugUrl" plugin name,
                internally, this will be stored as simply "bugurl". If another plugin is registered
                with simply a different word case, it will overwrite this entry.
            </p></td></tr>
</table></div>
</div>
<div class="section" title="19.2.3. Configuration Options">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.loader.plugin-class-loader.options"></a>19.2.3. Configuration Options</h3></div></div></div>
<div class="variablelist" title="PluginClassLoader Options">
<p class="title"><b>PluginClassLoader Options</b></p>
<dl>
<dt><span class="term">$map</span></dt>
<dd><p>
                        The constructor may take a single option, an array or
                        <code class="interfacename">Traversable</code> object of key/value pairs
                        corresponding to a plugin name and class name, respectively.
                    </p></dd>
</dl>
</div>
</div>
<div class="section" title="19.2.4. Available Methods"><div class="titlepage"><div><div><h3 class="title">
<a name="zend.loader.plugin-class-loader.methods"></a>19.2.4. Available Methods</h3></div></div></div></div>
<div class="section" title="19.2.5. Examples">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.loader.plugin-class-loader.examples"></a>19.2.5. Examples</h3></div></div></div>
<div class="example">
<a name="zend.loader.plugin-class-loader.examples.static-maps"></a><p class="title"><b>Example 19.1. Using Static Maps</b></p>
<div class="example-contents">
<p>
                It's often convenient to provide global overrides or additions to the maps in a
                <code class="classname">PluginClassLoader</code> instance. This can be done using the
                <code class="methodname">addStaticMap()</code> method:
            </p>
<pre class="programlisting">
use Zend\Loader\PluginClassLoader;

PluginClassLoader::addStaticMap(array(
    'url' =&gt; 'Zend\View\Helper\Url',
));
</pre>
<p>
                Any later instances created will now have this map defined, allowing you to load
                that plugin.
            </p>
<pre class="programlisting">
use Zend\Loader\PluginClassLoader;

$loader = new PluginClassLoader();
$helper = $loader-&gt;load('url'); // Zend\View\Helper\Url
</pre>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.loader.plugin-class-loader.examples.extended-loader"></a><p class="title"><b>Example 19.2. Creating a pre-loaded map</b></p>
<div class="example-contents">
<p>
                In many cases, you know exactly which plugins you may be drawing upon on a regular
                basis, and which classes they will refer to. In this case, simply extend the
                <code class="classname">PluginClassLoader</code> and define the map within the extending
                class.
            </p>
<pre class="programlisting">
namespace My\Plugins;

use Zend\Loader\PluginClassLoader;

class PluginLoader extends PluginClassLoader
{
    /**
     * @var array Plugin map
     */
    protected $plugins = array(
        'foo'    =&gt; 'My\Plugins\Foo',
        'bar'    =&gt; 'My\Plugins\Bar',
        'foobar' =&gt; 'My\Plugins\FooBar',
    );
}
</pre>
<p>
                At this point, you can simply instantiate the map and use it.
            </p>
<pre class="programlisting">
$loader = new My\Plugins\PluginLoader();
$class  = $loader-&gt;load('foobar'); // My\Plugins\FooBar
</pre>
<p>
                <code class="classname">PluginClassLoader</code> makes use of late static binding, allowing
                per-class static maps.  If you want to allow defining a <a class="link" href="zend.loader.plugin-class-loader.html#zend.loader.plugin-class-loader.examples.static-maps" title="Example 19.1. Using Static Maps">static map</a>
                specific to this extending class, simply declare a protected static
                <code class="varname">$staticMap</code> property:
            </p>
<pre class="programlisting">
namespace My\Plugins;

use Zend\Loader\PluginClassLoader;

class PluginLoader extends PluginClassLoader
{
    protected static $staticMap = array();

    // ...
}
</pre>
<p>
                To inject the static map, use the extending class' name to call the static
                <code class="methodname">addStaticMap()</code> method.
            </p>
<pre class="programlisting">
PluginLoader::addStaticMap(array(
    'url' =&gt; 'Zend\View\Helper\Url',
));
</pre>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.loader.plugin-class-loader.examples.using-as-plugin-map"></a><p class="title"><b>Example 19.3. Extending a plugin map using another plugin map</b></p>
<div class="example-contents">
<p>
                In some cases, a general map class may already exist; as an example, most components
                in Zend Framework that utilize a plugin broker have an associated
                <code class="classname">PluginClassLoader</code> extension defining the plugins available
                for that component within the framework. What if you want to define some additions
                to these? Where should that code go?
            </p>
<p>
                One possibility is to define the map in a configuration file, and then inject the
                configuration into an instance of the plugin loader. This is certainly trivial to
                implement, but removes the code defining the plugin map from the library.
            </p>
<p>
                An alternate solution is to define a new plugin map class. The class name or an
                instance of the class may then be passed to the constructor or
                <code class="methodname">registerPlugins()</code>.
            </p>
<pre class="programlisting">
namespace My\Plugins;

use Zend\Loader\PluginClassLoader,
    Zend\View\Helper\HelperLoader;

class PluginLoader extends PluginClassLoader
{
    /**
     * @var array Plugin map
     */
    protected $plugins = array(
        'foo'    =&gt; 'My\Plugins\Foo',
        'bar'    =&gt; 'My\Plugins\Bar',
        'foobar' =&gt; 'My\Plugins\FooBar',
    );
}

// Inject in constructor:
$loader = new HelperLoader('My\Plugins\PluginLoader');
$loader = new HelperLoader(new PluginLoader());

// Or via registerPlugins():
$loader-&gt;registerPlugins('My\Plugins\PluginLoader');
$loader-&gt;registerPlugins(new PluginLoader());
</pre>
</div>
</div>
<br class="example-break">
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.loader.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.loader.plugin-class-loader.methods.constructor.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">getRegisteredAutoloaders </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> __construct</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
