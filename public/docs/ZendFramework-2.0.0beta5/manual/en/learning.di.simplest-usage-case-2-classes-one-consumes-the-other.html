<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>3. Simplest usage case (2 classes, one consumes the other)</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="learning.di.html" title="Learning Dependency Injection">
<link rel="prev" href="learning.di.very-brief-introduction-to-di-container.html" title="2. Very brief introduction to Di Container.">
<link rel="next" href="learning.di.simplest-usage-case-without-type-hints.html" title="4. Simplest Usage Case Without Type-hints">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">3. Simplest usage case (2 classes, one consumes the other)</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="learning.di.very-brief-introduction-to-di-container.html">Prev</a> </td>
<th width="60%" align="center">Learning Dependency Injection</th>
<td width="20%" align="right"> <a accesskey="n" href="learning.di.simplest-usage-case-without-type-hints.html">Next</a>
</td>
</tr>
</table></div>
<div class="section" title="3. Simplest usage case (2 classes, one consumes the other)">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="learning.di.simplest-usage-case-2-classes-one-consumes-the-other"></a>3. Simplest usage case (2 classes, one consumes the other)</h2></div></div></div>
<p>
    In the simplest use case, a developer might have one class
    (<code class="literal">A</code>) that is consumed by another class
    (<code class="literal">B</code>) through the constructor. By having the
    dependency injected through the constructor, this requires an object
    of type <code class="literal">A</code> be instantiated before an object of
    type <code class="literal">B</code> so that <code class="literal">A</code> can be
    injected into <code class="literal">B</code>.
  </p>
<pre class="programlisting">
namespace My {

    class A
    {
        /* Some useful functionality */
    }

    class B
    {
        protected $a = null;
        public function __construct(A $a)
        {
            $this-&gt;a = $a;
        }
    }
}
</pre>
<p>
    To create <code class="literal">B</code> by hand, a developer would follow
    this work flow, or a similar workflow to this:
  </p>
<pre class="programlisting">
$b = new B(new A());
</pre>
<p>
    If this workflow becomes repeated throughout your application
    multiple times, this creates an opportunity where one might want to
    DRY up the code. While there are several ways to do this, using a
    dependency injection container is one of these solutions. With
    Zend's dependency injection container
    <code class="literal">Zend\Di\DependencyInjector</code>, the above use case
    can be taken care of with no configuration (provided all of your
    autoloading is already configured properly) with the following
    usage:
  </p>
<pre class="programlisting">
$di = new Zend\Di\DependencyInjector;
$b = $di-&gt;get('My\B'); // will produce a B object that is consuming an A object
</pre>
<p>
    Moreover, by using the <code class="literal">DependencyInjector::get()</code>
    method, you are ensuring that the same exact object is returned on
    subsequent calls. To force new objects to be created on each and
    every request, one would use the
    <code class="literal">DependencyInjector::newInstance()</code> method:
  </p>
<pre class="programlisting">
$b = $di-&gt;newInstance('My\B');
</pre>
<p>
    Let's assume for a moment that <code class="literal">A</code> requires some
    configuration before it can be created. Our previous use case is
    expanded to this (we'll throw a 3rd class in for good measure):
  </p>
<pre class="programlisting">
namespace My {

    class A
    {
        protected $username = null;
        protected $password = null;
        public function __construct($username, $password)
        {
            $this-&gt;username = $username;
            $this-&gt;password = $password;
        }
    }

    class B
    {
        protected $a = null;
        public function __construct(A $a)
        {
            $this-&gt;a = $a;
        }
    }

    class C
    {
        protected $b = null;
        public function __construct(B $b)
        {
            $this-&gt;b = $b;
        }
    }

}
</pre>
<p>
    With the above, we need to ensure that our
    <code class="literal">DependencyInjector</code> is capable of seeing the
    <code class="literal">A</code> class with a few configuration values (which
    are generally scalar in nature). To do this, we need to interact
    with the <code class="literal">InstanceManager</code>:
  </p>
<pre class="programlisting">
$di = new Zend\Di\DependencyInjector;
$di-&gt;getInstanceManager()-&gt;setProperty('A', 'username', 'MyUsernameValue');
$di-&gt;getInstanceManager()-&gt;setProperty('A', 'password', 'MyHardToGuessPassword%$#');
</pre>
<p>
    Now that our container has values it can use when creating
    <code class="literal">A</code>, and our new goal is to have a
    <code class="literal">C</code> object that consumes <code class="literal">B</code> and
    in turn consumes <code class="literal">A</code>, the usage scenario is still
    the same:
  </p>
<pre class="programlisting">
$c = $di-&gt;get('My\C');
// or
$c = $di-&gt;newInstance('My\C');
</pre>
<p>
    Simple enough, but what if we wanted to pass in these parameters at
    call time? Assuming a default <code class="literal">DependencyInjector</code>
    object (<code class="literal">$di = new Zend\Di\DependencyInjector()</code>
    without any configuration to the
    <code class="literal">InstanceManager</code>), we could do the following:
  </p>
<pre class="programlisting">
$parameters = array(
    'username' =&gt; 'MyUsernameValue',
    'password' =&gt; 'MyHardToGuessPassword%$#',
);

$c = $di-&gt;get('My\C', $parameters);
// or
$c = $di-&gt;newInstance('My\C', $parameters);
</pre>
<p>
    Constructor injection is not the only supported type of injection.
    The other most popular method of injection is also supported: setter
    injection. Setter injection allows one to have a usage scenario that
    is the same as our previous example with the exception, for example,
    of our <code class="literal">B</code> class now looking like this:
  </p>
<pre class="programlisting">
namespace My {
    class B
    {
        protected $a;
        public function setA(A $a)
        {
            $this-&gt;a = $a;
        }
    }
}
</pre>
<p>
    Since the method is prefixed with set, and is followed by a capital
    letter, the <code class="literal">DependencyInjector</code> knows that this
    method is used for setter injection, and again, the use case
    <code class="literal">$c = $di-&gt;get('C')</code>, will once again know how
    to fill the dependencies when needed to create an object of type
    <code class="literal">C</code>.
  </p>
<p>
    Other methods are being created to determine what the wirings
    between classes are, such as interface injection and annotation
    based injection.
  </p>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="learning.di.very-brief-introduction-to-di-container.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="learning.di.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="learning.di.simplest-usage-case-without-type-hints.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">2. Very brief introduction to Di Container. </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 4. Simplest Usage Case Without Type-hints</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
