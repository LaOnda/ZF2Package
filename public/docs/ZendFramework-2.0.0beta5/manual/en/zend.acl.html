<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Chapter 3. Zend\Acl</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="prev" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="next" href="zend.acl.refining.html" title="3.2. Refining Access Controls">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
<link rel="section" href="zend.acl.html#zend.acl.introduction" title="3.1. Introduction">
<link rel="section" href="zend.acl.refining.html" title="3.2. Refining Access Controls">
<link rel="section" href="zend.acl.advanced.html" title="3.3. Advanced Usage">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Chapter 3. Zend\Acl</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="reference.html">Prev</a> </td>
<th width="60%" align="center">Part III. Zend Framework Reference</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.acl.refining.html">Next</a>
</td>
</tr>
</table></div>
<div class="chapter" title="Chapter 3. Zend\Acl">
<div class="titlepage"><div><div><h2 class="title">
<a name="zend.acl"></a>Chapter 3. Zend\Acl</h2></div></div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction">3.1. Introduction</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.resources">3.1.1. Resources</a></span></dt>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.roles">3.1.2. Roles</a></span></dt>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.creating">3.1.3. Creating the Access Control List</a></span></dt>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.role_registry">3.1.4. Registering Roles</a></span></dt>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.defining">3.1.5. Defining Access Controls</a></span></dt>
<dt><span class="section"><a href="zend.acl.html#zend.acl.introduction.querying">3.1.6. Querying an ACL</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="zend.acl.refining.html">3.2. Refining Access Controls</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="zend.acl.refining.html#zend.acl.refining.precise">3.2.1. Precise Access Controls</a></span></dt>
<dt><span class="section"><a href="zend.acl.refining.html#zend.acl.refining.removing">3.2.2. Removing Access Controls</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="zend.acl.advanced.html">3.3. Advanced Usage</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="zend.acl.advanced.html#zend.acl.advanced.storing">3.3.1. Storing ACL Data for Persistence</a></span></dt>
<dt><span class="section"><a href="zend.acl.advanced.html#zend.acl.advanced.assertions">3.3.2. Writing Conditional ACL Rules with Assertions</a></span></dt>
</dl></dd>
</dl>
</div>
<div class="section" title="3.1. Introduction">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.acl.introduction"></a>3.1. Introduction</h2></div></div></div>
<p>
        The <code class="classname">Zend\Acl</code> component provides a lightweight and flexible access control list
        (<acronym class="acronym">ACL</acronym>) implementation for privileges management. In general, an
        application may utilize such <acronym class="acronym">ACL</acronym>'s to control access to certain
        protected objects by other requesting objects.
    </p>
<p>
        For the purposes of this documentation:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                a <span class="emphasis"><em>resource</em></span> is an object
                to which access is controlled.
            </p></li>
<li class="listitem"><p>
                a <span class="emphasis"><em>role</em></span> is an object
                that may request access to a Resource.
            </p></li>
</ul></div>
<p>
        Put simply, <span class="emphasis"><em>roles request access to resources</em></span>. For
        example, if a parking attendant requests access to a car, then the parking attendant is the
        requesting role, and the car is the resource, since access to the car may not be granted to
        everyone.
    </p>
<p>
        Through the specification and use of an <acronym class="acronym">ACL</acronym>, an application may control
        how roles are granted access to resources.
    </p>
<div class="section" title="3.1.1. Resources">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.resources"></a>3.1.1. Resources</h3></div></div></div>
<p>
            Creating a resource using <code class="classname">Zend\Acl\Acl</code> is very simple.
            A resource interface <code class="classname">Zend\Acl\Resource\ResourceInterface</code> is provided to facilitate creating resources in
            an application. A class need only implement this interface, which consists of a single
            method, <code class="methodname">getResourceId()</code>, for <code class="classname">Zend\Acl\Acl</code> 
            to recognize the object as a resource. Additionally, 
            <code class="classname">Zend\Acl\Resource\GenericResource</code> is provided as a basic resource implementation 
            for developers to extend as needed.
        </p>
<p>
            <code class="classname">Zend\Acl\Acl</code> provides a tree structure to which multiple resources
            can be added. Since resources are stored in such a tree structure, they can be
            organized from the general (toward the tree root) to the specific (toward the tree
            leaves). Queries on a specific resource will automatically search the resource's
            hierarchy for rules assigned to ancestor resources, allowing for simple inheritance of
            rules. For example, if a default rule is to be applied to each building in a city, one
            would simply assign the rule to the city, instead of assigning the same rule to each
            building. Some buildings may require exceptions to such a rule, however, and this can
            be achieved in <code class="classname">Zend\Acl\Acl</code> by assigning such exception rules to
            each building that requires such an exception. A resource may inherit from only one
            parent resource, though this parent resource can have its own parent resource, etc.
        </p>
<p>
            <code class="classname">Zend\Acl\Acl</code> also supports privileges on resources (e.g., "create",
            "read", "update", "delete"), so the developer can assign rules that affect all
            privileges or specific privileges on one or more resources.
        </p>
</div>
<div class="section" title="3.1.2. Roles">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.roles"></a>3.1.2. Roles</h3></div></div></div>
<p>
            As with resources, creating a role is also very simple. All roles must implement
            <code class="classname">Zend\Acl\Role\RoleInterface</code>. This interface consists of a single
            method, <code class="methodname">getRoleId()</code>, Additionally,
            <code class="classname">Zend\Acl\Role\GenericRole</code> is provided by the <code class="classname">Zend\Acl</code> component as
            a basic role implementation for developers to extend as needed.
        </p>
<p>
            In <code class="classname">Zend\Acl\Acl</code>, a role may inherit from one or more roles. This is
            to support inheritance of rules among roles. For example, a user role, such as "sally",
            may belong to one or more parent roles, such as "editor" and "administrator". The
            developer can assign rules to "editor" and "administrator" separately, and "sally"
            would inherit such rules from both, without having to assign rules directly to "sally".
        </p>
<p>
            Though the ability to inherit from multiple roles is very useful, multiple inheritance
            also introduces some degree of complexity. The following example illustrates the
            ambiguity condition and how <code class="classname">Zend\Acl\Acl</code> solves it.
        </p>
<div class="example">
<a name="zend.acl.introduction.roles.example.multiple_inheritance"></a><p class="title"><b>Example 3.1. Multiple Inheritance among Roles</b></p>
<div class="example-contents">
<p>
                The following code defines three base roles - "guest",
                "member", and "admin" - from which other roles may
                inherit. Then, a role identified by "someUser" is established and
                inherits from the three other roles. The order in which these roles appear in the
                <code class="varname">$parents</code> array is important. When necessary,
                <code class="classname">Zend\Acl\Acl</code> searches for access rules defined not only for the
                queried role (herein, "someUser"), but also upon the roles from which
                the queried role inherits (herein, "guest", "member", and
                "admin"):
            </p>
<pre class="programlisting">
use Zend\Acl\Acl,
    Zend\Acl\Role\GenericRole as Role,
    Zend\Acl\Resource\GenericResource as Resource;

$acl = new Acl();

$acl-&gt;addRole(new Role('guest'))
    -&gt;addRole(new Role('member'))
    -&gt;addRole(new Role('admin'));

$parents = array('guest', 'member', 'admin');
$acl-&gt;addRole(new Role('someUser'), $parents);

$acl-&gt;add(new Resource('someResource'));

$acl-&gt;deny('guest', 'someResource');
$acl-&gt;allow('member', 'someResource');

echo $acl-&gt;isAllowed('someUser', 'someResource') ? 'allowed' : 'denied';
</pre>
</div>
</div>
<br class="example-break"><p>
            Since there is no rule specifically defined for the "someUser" role and
            "someResource", <code class="classname">Zend\Acl\Acl</code> must search for rules that may be
            defined for roles that "someUser" inherits. First, the "admin" role is visited, and
            there is no access rule defined for it. Next, the "member" role is visited, and
            <code class="classname">Zend\Acl\Acl</code> finds that there is a rule specifying that "member"
            is allowed access to "someResource".
        </p>
<p>
            If <code class="classname">Zend\Acl\Acl</code> were to continue examining the rules defined for
            other parent roles, however, it would find that "guest" is denied access to
            "someResource". This fact introduces an ambiguity because now
            "someUser" is both denied and allowed access to "someResource", by reason of having
            inherited conflicting rules from different parent roles.
        </p>
<p>
            <code class="classname">Zend\Acl\Acl</code> resolves this ambiguity by completing a query when
            it finds the first rule that is directly applicable to the query. In this case,
            since the "member" role is examined before the "guest" role, the example code would
            print "allowed".
        </p>
<div class="note" title="Note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                When specifying multiple parents for a role, keep in mind that the last parent
                listed is the first one searched for rules applicable to an authorization query.
            </p></td></tr>
</table></div>
</div>
<div class="section" title="3.1.3. Creating the Access Control List">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.creating"></a>3.1.3. Creating the Access Control List</h3></div></div></div>
<p>
            An Access Control List (<acronym class="acronym">ACL</acronym>) can represent any set of physical or
            virtual objects that you wish. For the purposes of demonstration, however, we will
            create a basic Content Management System (<acronym class="acronym">CMS</acronym>)
            <acronym class="acronym">ACL</acronym> that maintains several tiers of groups over a wide variety of
            areas. To create a new <acronym class="acronym">ACL</acronym> object, we instantiate the
            <acronym class="acronym">ACL</acronym> with no parameters:
        </p>
<pre class="programlisting">
use Zend\Acl\Acl;
$acl = new Acl();
</pre>
<div class="note" title="Note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                Until a developer specifies an "allow" rule, <code class="classname">Zend\Acl\Acl</code> denies
                access to every privilege upon every resource by every role.
            </p></td></tr>
</table></div>
</div>
<div class="section" title="3.1.4. Registering Roles">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.role_registry"></a>3.1.4. Registering Roles</h3></div></div></div>
<p>
            <acronym class="acronym">CMS</acronym>'s will nearly always require a hierarchy of permissions to
            determine the authoring capabilities of its users. There may be a 'Guest' group to
            allow limited access for demonstrations, a 'Staff' group for the majority of
            <acronym class="acronym">CMS</acronym> users who perform most of the day-to-day operations, an 'Editor'
            group for those responsible for publishing, reviewing, archiving and deleting content,
            and finally an 'Administrator' group whose tasks may include all of those of the other
            groups as well as maintenance of sensitive information, user management, back-end
            configuration data, backup and export. This set of permissions can be represented in a
            role registry, allowing each group to inherit privileges from 'parent' groups, as well
            as providing distinct privileges for their unique group only. The permissions may be
            expressed as follows:
        </p>
<div class="table">
<a name="zend.acl.introduction.role_registry.table.example_cms_access_controls"></a><p class="title"><b>Table 3.1. Access Controls for an Example CMS</b></p>
<div class="table-contents"><table summary="Access Controls for an Example CMS" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Name</th>
<th>Unique Permissions</th>
<th>Inherit Permissions From</th>
</tr></thead>
<tbody>
<tr>
<td>Guest</td>
<td>View</td>
<td>N/A</td>
</tr>
<tr>
<td>Staff</td>
<td>Edit, Submit, Revise</td>
<td>Guest</td>
</tr>
<tr>
<td>Editor</td>
<td>Publish, Archive, Delete</td>
<td>Staff</td>
</tr>
<tr>
<td>Administrator</td>
<td>(Granted all access)</td>
<td>N/A</td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><p>
            For this example, <code class="classname">Zend\Acl\Role\GenericRole</code> is used, but any object that
            implements <code class="classname">Zend\Acl\Role\RoleInterface</code> is acceptable. These groups
            can be added to the role registry as follows:
        </p>
<pre class="programlisting">
use Zend\Acl\Acl,
    Zend\Acl\Role\GenericRole as Role,
    Zend\Acl\Resource\GenericResource as Resource;

$acl = new Acl();

// Add groups to the Role registry using Zend\Acl\Role\GenericRole
// Guest does not inherit access controls
$roleGuest = new Role('guest');
$acl-&gt;addRole($roleGuest);

// Staff inherits from guest
$acl-&gt;addRole(new Role('staff'), $roleGuest);

/*
Alternatively, the above could be written:
$acl-&gt;addRole(new Role('staff'), 'guest');
*/

// Editor inherits from staff
$acl-&gt;addRole(new Role('editor'), 'staff');

// Administrator does not inherit access controls
$acl-&gt;addRole(new Role('administrator'));
</pre>
</div>
<div class="section" title="3.1.5. Defining Access Controls">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.defining"></a>3.1.5. Defining Access Controls</h3></div></div></div>
<p>
            Now that the <acronym class="acronym">ACL</acronym> contains the relevant roles, rules can be
            established that define how resources may be accessed by roles. You may have noticed
            that we have not defined any particular resources for this example, which is simplified
            to illustrate that the rules apply to all resources. <code class="classname">Zend\Acl\Acl</code>
            provides an implementation whereby rules need only be assigned from general to
            specific, minimizing the number of rules needed, because resources and roles inherit
            rules that are defined upon their ancestors.
        </p>
<div class="note" title="Note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                In general, <code class="classname">Zend\Acl\Acl</code> obeys a given rule if and only if a
                more specific rule does not apply.
            </p></td></tr>
</table></div>
<p>
            Consequently, we can define a reasonably complex set of rules with a minimum amount of
            code. To apply the base permissions as defined above:
        </p>
<pre class="programlisting">
use Zend\Acl\Acl,
    Zend\Acl\Role\GenericRole as Role;

$acl = new Acl();

$roleGuest = new Role('guest');
$acl-&gt;addRole($roleGuest);
$acl-&gt;addRole(new Role('staff'), $roleGuest);
$acl-&gt;addRole(new Role('editor'), 'staff');
$acl-&gt;addRole(new Role('administrator'));

// Guest may only view content
$acl-&gt;allow($roleGuest, null, 'view');

/*
Alternatively, the above could be written:
$acl-&gt;allow('guest', null, 'view');
//*/

// Staff inherits view privilege from guest, but also needs additional
// privileges
$acl-&gt;allow('staff', null, array('edit', 'submit', 'revise'));

// Editor inherits view, edit, submit, and revise privileges from
// staff, but also needs additional privileges
$acl-&gt;allow('editor', null, array('publish', 'archive', 'delete'));

// Administrator inherits nothing, but is allowed all privileges
$acl-&gt;allow('administrator');
</pre>
<p>
            The <code class="constant">NULL</code> values in the above <code class="methodname">allow()</code> calls
            are used to indicate that the allow rules apply to all resources.
        </p>
</div>
<div class="section" title="3.1.6. Querying an ACL">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.acl.introduction.querying"></a>3.1.6. Querying an ACL</h3></div></div></div>
<p>
            We now have a flexible <acronym class="acronym">ACL</acronym> that can be used to determine whether
            requesters have permission to perform functions throughout the web application.
            Performing queries is quite simple using the <code class="methodname">isAllowed()</code>
            method:
        </p>
<pre class="programlisting">
echo $acl-&gt;isAllowed('guest', null, 'view') ?
     "allowed" : "denied";
// allowed

echo $acl-&gt;isAllowed('staff', null, 'publish') ?
     "allowed" : "denied";
// denied

echo $acl-&gt;isAllowed('staff', null, 'revise') ?
     "allowed" : "denied";
// allowed

echo $acl-&gt;isAllowed('editor', null, 'view') ?
     "allowed" : "denied";
// allowed because of inheritance from guest

echo $acl-&gt;isAllowed('editor', null, 'update') ?
     "allowed" : "denied";
// denied because no allow rule for 'update'

echo $acl-&gt;isAllowed('administrator', null, 'view') ?
     "allowed" : "denied";
// allowed because administrator is allowed all privileges

echo $acl-&gt;isAllowed('administrator') ?
     "allowed" : "denied";
// allowed because administrator is allowed all privileges

echo $acl-&gt;isAllowed('administrator', null, 'update') ?
     "allowed" : "denied";
// allowed because administrator is allowed all privileges
</pre>
</div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="reference.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="reference.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.acl.refining.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Part III. Zend Framework Reference </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 3.2. Refining Access Controls</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
