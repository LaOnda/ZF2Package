<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>21.4. The Module Autoloader</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="prev" href="zend.module-manager.module-class.html" title="21.3. The Module Class">
<link rel="next" href="zend.module-manager.best-practices.html" title="21.5. Best Practices when Creating Modules">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
<link rel="subsection" href="zend.module-manager.module-autoloader.html#zend.module-manager.module-autoloader.usage" title="21.4.1. Module Autoloader Usage">
<link rel="subsection" href="zend.module-manager.module-autoloader.html#zend.module-manager.module-autoloader.non-standard-module-paths" title="21.4.2. Non-Standard / Explicit Module Paths">
<link rel="subsection" href="zend.module-manager.module-autoloader.html#zend.module-manager.module-autoloader.packaging-modules-with-phar" title="21.4.3. Packaging Modules with Phar">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">21.4. The Module Autoloader</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.module-manager.module-class.html">Prev</a> </td>
<th width="60%" align="center">Chapter 21. Zend\ModuleManager</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.module-manager.best-practices.html">Next</a>
</td>
</tr>
</table></div>
<div class="section" title="21.4. The Module Autoloader">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.module-manager.module-autoloader"></a>21.4. The Module Autoloader</h2></div></div></div>
<p>
        Zend Framework 2 ships with a default module autoloader.
        <code class="classname">Zend\Loader\ModuleAutoloader</code> is a specialized autoloader that is
        responsible for location of, and on-demand loading of, the <code class="classname">Module</code>
        classes from a variety of sources.
    </p>
<div class="section" title="21.4.1. Module Autoloader Usage">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.module-manager.module-autoloader.usage"></a>21.4.1. Module Autoloader Usage</h3></div></div></div>
<p>
            If you are using the provided
            <code class="classname">Zend\ModuleManager\Listener\DefaultListenerAggregate</code>, then it is very
            simple to set up the module autoloader. You simply need to provide an array of module
            paths, either absolute or relative to the application's root, for the module autoloader
            to check when loading modules. The default listener aggregate will take care of
            instantiating and registering the module autoloader for you.
        </p>
<p>
            Keep in mind that in order for paths relative to your application directory to work, you
            must have the directive <code class="code">chdir(dirname(__DIR__));</code> in your
            <code class="filename">public/index.php</code>.
        </p>
<div class="example">
<a name="zend.module-manager.module-autoloader.example.module-autoloading"></a><p class="title"><b>Example 21.5. Registering module paths with the default listener aggregate</b></p>
<div class="example-contents">
<p>
                The following example will search for modules in three different paths. Two are
                local directories for this application, and the third is a system-wide shared
                directory.
            </p>
<pre class="programlisting">
// public/index.php
use Zend\ModuleManager\Listener;
use Zend\ModuleManager\ModuleManager;

chdir(dirname(__DIR__));

// Instantiate and configure the default listener aggregate
$listenerOptions = new Listener\ListenerOptions(array(
    'module_paths' =&gt; array(
        './module',
        './vendor',
        '/usr/share/zfmodules',
    )
));
$defaultListeners = new Listener\DefaultListenerAggregate($listenerOptions);

// Instantiate the module manager
$moduleManager = new ModuleManager(array(
    'Application',
    'FooModule',
    'BarModule',
));

// Attach the default listener aggregate and load the modules
$moduleManager-&gt;getEventManager()-&gt;attachAggregate($defaultListeners);
$moduleManager-&gt;loadModules();
</pre>
</div>
</div>
<br class="example-break"><div class="note" title="Note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                Module paths behave very similar to the PHP include path, and are searched in the
                order they are defined. If you have modules with the same name in more than one
                registered module path, the module autoloader will return the first one it finds.
            </p></td></tr>
</table></div>
</div>
<div class="section" title="21.4.2. Non-Standard / Explicit Module Paths">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.module-manager.module-autoloader.non-standard-module-paths"></a>21.4.2. Non-Standard / Explicit Module Paths</h3></div></div></div>
<p>
            Sometimes you may want to specify exactly where a module is instead of having
            <code class="classname">Zend\Loader\ModuleAutoloader</code> try to find it in the registered
            paths.
        </p>
<div class="example">
<a name="zend.module-manager.module-autoloader.example.module-loading-nonstandard-paths"></a><p class="title"><b>Example 21.6. Registering a Non-Standard / Explicit Module Path</b></p>
<div class="example-contents">
<p>
                In this example, the autoloader will first check for
                <code class="classname">MyModule\Module</code> in
                <code class="filename">/path/to/mymoduledir-v1.2/Module.php</code>. If it's not found, then
                it will fall back to searching any other registered module paths.
            </p>
<pre class="programlisting">
// ./public/index.php
use Zend\Loader\ModuleAutoloader;
use Zend\ModuleManager\Listener;
use Zend\ModuleManager\ModuleManager;

chdir(dirname(__DIR__));

// Instantiate and configure the default listener aggregate
$listenerOptions = new Listener\ListenerOptions(array(
    'module_paths' =&gt; array(
        './module',
        './vendor',
        '/usr/share/zfmodules',
        'MyModule' =&gt; '/path/to/mymoduledir-v1.2',
    )
));
$defaultListeners = new Listener\DefaultListenerAggregate($listenerOptions);

/**
 * Without DefaultListenerAggregate:
 *
 * $moduleAutoloader = new ModuleAutoloader(array(
 *     './module',
 *     './vendor',
 *     '/usr/share/zfmodules',
 *     'MyModule' =&gt; '/path/to/mymoduledir-v1.2',
 * ));
 * $moduleAutoloader-&gt;register();
 *
 */

// Instantiate the module manager
$moduleManager = new ModuleManager(array(
    'MyModule',
    'FooModule',
    'BarModule',
));

// Attach the default listener aggregate and load the modules
$moduleManager-&gt;getEventManager()-&gt;attachAggregate($defaultListeners);
$moduleManager-&gt;loadModules();
</pre>
</div>
</div>
<br class="example-break"><p>
            This same method works if you provide the path to a phar archive.
        </p>
</div>
<div class="section" title="21.4.3. Packaging Modules with Phar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.module-manager.module-autoloader.packaging-modules-with-phar"></a>21.4.3. Packaging Modules with Phar</h3></div></div></div>
<p>
            If you prefer, you may easily package your module as a <a class="link" href="http://php.net/phar" target="_top">phar archive</a>. The module autoloader is able
            to autoload modules in the following archive formats: .phar, .phar.gz, .phar.bz2,
            .phar.tar, .phar.tar.gz, .phar.tar.bz2, .phar.zip, .tar, .tar.gz, .tar.bz2, and .zip.
        </p>
<p>
            The easiest way to package your module is to simply tar the module directory. You can
            then replace the <code class="filename">MyModule/</code> directory with
            <code class="filename">MyModule.tar</code>, and it should still be autoloaded without any
            additional changes!
        </p>
<div class="note" title="Note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
                If possible, avoid using any type of compression (bz2, gz, zip) on your phar
                archives, as it introduces unnecessary CPU overhead to each request.
            </p></td></tr>
</table></div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.module-manager.module-class.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.module-manager.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.module-manager.best-practices.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">21.3. The Module Class </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 21.5. Best Practices when Creating Modules</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
