<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>26.4. Writing Validators</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="prev" href="zend.validator.validator_chains.html" title="26.3. Validator Chains">
<link rel="next" href="zend.validator.messages.html" title="26.5. Validation Messages">
<link rel="part" href="introduction.html" title="Part I. Introduction to Zend Framework">
<link rel="chapter" href="introduction.overview.html" title="Chapter 1. Overview">
<link rel="chapter" href="introduction.installation.html" title="Chapter 2. Installation">
<link rel="part" href="learning.html" title="Part II. Learning Zend Framework">
<link rel="article" href="learning.di.html" title="Learning Dependency Injection">
<link rel="part" href="reference.html" title="Part III. Zend Framework Reference">
<link rel="chapter" href="zend.acl.html" title="Chapter 3. Zend\Acl">
<link rel="chapter" href="zend.authentication.html" title="Chapter 4. Zend\Authentication">
<link rel="chapter" href="zend.barcode.html" title="Chapter 5. Zend\Barcode">
<link rel="chapter" href="zend.cache.html" title="Chapter 6. Zend\Cache">
<link rel="chapter" href="zend.captcha.html" title="Chapter 7. Zend\Captcha">
<link rel="chapter" href="zend.config.html" title="Chapter 8. Zend_Config">
<link rel="chapter" href="zend.crypt.html" title="Chapter 9. Zend_Crypt">
<link rel="chapter" href="zend.db.html" title="Chapter 10. Zend_Db">
<link rel="chapter" href="zend.di.html" title="Chapter 11. Zend\Di">
<link rel="chapter" href="zend.dom.html" title="Chapter 12. Zend\Dom">
<link rel="chapter" href="zend.event-manager.html" title="Chapter 13. Zend\EventManager">
<link rel="chapter" href="zend.form.html" title="Chapter 14. Zend_Form">
<link rel="chapter" href="zend.http.html" title="Chapter 15. Zend_Http">
<link rel="chapter" href="zend.i18n.html" title="Chapter 16. Zend_I18n">
<link rel="chapter" href="zend.input-filter.html" title="Chapter 17. Zend\InputFilter">
<link rel="chapter" href="zend.ldap.html" title="Chapter 18. Zend_Ldap">
<link rel="chapter" href="zend.loader.html" title="Chapter 19. Zend\Loader">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.factory.html" title="factory">
<link rel="refentry" href="zend.loader.autoloader-factory.methods.get-registered-autoloaders.html" title="getRegisteredAutoloaders">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.add-static-map.html" title="addStaticMap">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.register-plugins.html" title="registerPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-loader.methods.get-iterator.html" title="getIterator">
<link rel="refentry" href="zend.loader.short-name-locator.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.short-name-locator.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.short-name-locator.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.register-plugin.html" title="registerPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.unregister-plugin.html" title="unregisterPlugin">
<link rel="refentry" href="zend.loader.plugin-class-locator.methods.get-registered-plugins.html" title="getRegisteredPlugins">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.spl-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-map.html" title="registerAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register-autoload-maps.html" title="registerAutoloadMaps">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.get-autoload-map.html" title="getAutoloadMap">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.class-map-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.set-fallback-autoloader.html" title="setFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.is-fallback-autoloader.html" title="isFallbackAutoloader">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespace.html" title="registerNamespace">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-namespaces.html" title="registerNamespaces">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefix.html" title="registerPrefix">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register-prefixes.html" title="registerPrefixes">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.autoload.html" title="autoload">
<link rel="refentry" href="zend.loader.standard-autoloader.methods.register.html" title="register">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.constructor.html" title="__construct">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-static-paths.html" title="addStaticPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.set-options.html" title="setOptions">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.add-prefix-paths.html" title="addPrefixPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-paths.html" title="getPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.clear-paths.html" title="clearPaths">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.is-loaded.html" title="isLoaded">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-name.html" title="getClassName">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.load.html" title="load">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-plugin-map.html" title="getPluginMap">
<link rel="refentry" href="zend.loader.prefix-path-loader.methods.get-class-map.html" title="getClassMap">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.add-prefix-path.html" title="addPrefixPath">
<link rel="refentry" href="zend.loader.prefix-path-mapper.methods.remove-prefix-path.html" title="removePrefixPath">
<link rel="chapter" href="zend.mail.html" title="Chapter 20. Zend\Mail">
<link rel="chapter" href="zend.module-manager.html" title="Chapter 21. Zend\ModuleManager">
<link rel="chapter" href="zend.mvc.html" title="Chapter 22. Zend\Mvc">
<link rel="chapter" href="zend.service-manager.html" title="Chapter 23. Zend\ServiceManager">
<link rel="chapter" href="zend.stdlib.html" title="Chapter 24. Zend\Stdlib">
<link rel="chapter" href="zend.uri.html" title="Chapter 25. Zend_Uri">
<link rel="chapter" href="zend.validator.html" title="Chapter 26. Zend\Validator">
<link rel="chapter" href="zend.view.html" title="Chapter 27. Zend_View">
<link rel="chapter" href="zend.xmlrpc.html" title="Chapter 28. Zend_XmlRpc">
<link rel="appendix" href="copyrights.html" title="Appendix A. Copyright Information">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">26.4. Writing Validators</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.validator.validator_chains.html">Prev</a> </td>
<th width="60%" align="center">Chapter 26. Zend\Validator</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.validator.messages.html">Next</a>
</td>
</tr>
</table></div>
<div class="section" title="26.4. Writing Validators">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.validator.writing_validators"></a>26.4. Writing Validators</h2></div></div></div>
<p>
        <code class="classname">Zend\Validator\AbstractValidator</code> supplies a set of commonly needed validators, but
        inevitably, developers will wish to write custom validators for their particular needs. The
        task of writing a custom validator is described in this section.
    </p>
<p>
        <code class="interfacename">Zend\Validator\ValidatorInterface</code> defines two methods,
        <code class="methodname">isValid()</code> and <code class="methodname">getMessages()</code>, that may
        be implemented by user classes in order to create custom validation objects. An object that
        implements <code class="interfacename">Zend\Validator\AbstractValidator</code> interface may be added to a
        validator chain with <code class="methodname">Zend\Validator\ValidatorChain::addValidator()</code>. Such objects
        may also be used with <a class="link" href=""><code class="classname">Zend\Filter\Input</code></a>.
    </p>
<p>
        As you may already have inferred from the above description of
        <code class="interfacename">Zend\Validator\ValidatorInterface</code>, validation classes provided with Zend
        Framework return a boolean value for whether or not a value validates successfully. They
        also provide information about <span class="emphasis"><em>why</em></span> a value failed validation. The
        availability of the reasons for validation failures may be valuable to an application for
        various purposes, such as providing statistics for usability analysis.
    </p>
<p>
        Basic validation failure message functionality is implemented in
        <code class="classname">Zend\Validator\AbstractValidator</code>. To include this functionality when creating a
        validation class, simply extend <code class="classname">Zend\Validator\AbstractValidator</code>. In the
        extending class you would implement the <code class="methodname">isValid()</code> method logic and
        define the message variables and message templates that correspond to the types of
        validation failures that can occur. If a value fails your validation tests, then
        <code class="methodname">isValid()</code> should return <code class="constant">FALSE</code>. If the value
        passes your validation tests, then <code class="methodname">isValid()</code> should return
        <code class="constant">TRUE</code>.
    </p>
<p>
        In general, the <code class="methodname">isValid()</code> method should not throw any exceptions,
        except where it is impossible to determine whether or not the input value is valid. A few
        examples of reasonable cases for throwing an exception might be if a file cannot be opened,
        an <acronym class="acronym">LDAP</acronym> server could not be contacted, or a database connection is
        unavailable, where such a thing may be required for validation success or failure to be
        determined.
    </p>
<div class="example">
<a name="zend.validator.writing_validators.example.simple"></a><p class="title"><b>Example 26.3. Creating a Simple Validation Class</b></p>
<div class="example-contents">
<p>
            The following example demonstrates how a very simple custom validator might be written.
            In this case the validation rules are simply that the input value must be a floating
            point value.
        </p>
<pre class="programlisting">
class MyValid\Float extends Zend\Validator\AbstractValidator
{
    const FLOAT = 'float';

    protected $messageTemplates = array(
        self::FLOAT =&gt; "'%value%' is not a floating point value"
    );

    public function isValid($value)
    {
        $this-&gt;setValue($value);

        if (!is_float($value)) {
            $this-&gt;error(self::FLOAT);
            return false;
        }

        return true;
    }
}
</pre>
<p>
            The class defines a template for its single validation failure message, which includes
            the built-in magic parameter, <span class="emphasis"><em>%value%</em></span>. The call to
            <code class="methodname">setValue()</code> prepares the object to insert the tested value into
            the failure message automatically, should the value fail validation. The call to
            <code class="methodname">error()</code> tracks a reason for validation failure. Since this
            class only defines one failure message, it is not necessary to provide
            <code class="methodname">error()</code> with the name of the failure message template.
        </p>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.validator.writing_validators.example.conditions.dependent"></a><p class="title"><b>Example 26.4. Writing a Validation Class having Dependent Conditions</b></p>
<div class="example-contents">
<p>
            The following example demonstrates a more complex set of validation rules, where it is
            required that the input value be numeric and within the range of minimum and maximum
            boundary values. An input value would fail validation for exactly one of the following
            reasons:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>The input value is not numeric.</p></li>
<li class="listitem"><p>The input value is less than the minimum allowed value.</p></li>
<li class="listitem"><p>The input value is more than the maximum allowed value.</p></li>
</ul></div>
<p>
            These validation failure reasons are then translated to definitions in the class:
        </p>
<pre class="programlisting">
class MyValid\NumericBetween extends Zend\Validator\AbstractValidator
{
    const MSG_NUMERIC = 'msgNumeric';
    const MSG_MINIMUM = 'msgMinimum';
    const MSG_MAXIMUM = 'msgMaximum';

    public $minimum = 0;
    public $maximum = 100;

    protected $messageVariables = array(
        'min' =&gt; 'minimum',
        'max' =&gt; 'maximum'
    );

    protected $messageTemplates = array(
        self::MSG_NUMERIC =&gt; "'%value%' is not numeric",
        self::MSG_MINIMUM =&gt; "'%value%' must be at least '%min%'",
        self::MSG_MAXIMUM =&gt; "'%value%' must be no more than '%max%'"
    );

    public function isValid($value)
    {
        $this-&gt;_setValue($value);

        if (!is_numeric($value)) {
            $this-&gt;error(self::MSG_NUMERIC);
            return false;
        }

        if ($value &lt; $this-&gt;minimum) {
            $this-&gt;error(self::MSG_MINIMUM);
            return false;
        }

        if ($value &gt; $this-&gt;maximum) {
            $this-&gt;error(self::MSG_MAXIMUM);
            return false;
        }

        return true;
    }
}
</pre>
<p>
            The public properties <code class="varname">$minimum</code> and <code class="varname">$maximum</code> have
            been established to provide the minimum and maximum boundaries, respectively, for a
            value to successfully validate. The class also defines two message variables that
            correspond to the public properties and allow <span class="property">min</span> and
            <span class="property">max</span> to be used in message templates as magic parameters, just as
            with <span class="property">value</span>.
        </p>
<p>
            Note that if any one of the validation checks in <code class="methodname">isValid()</code>
            fails, an appropriate failure message is prepared, and the method immediately returns
            <code class="constant">FALSE</code>. These validation rules are therefore sequentially dependent.
            That is, if one test should fail, there is no need to test any subsequent validation
            rules. This need not be the case, however. The following example illustrates how to
            write a class having independent validation rules, where the validation object may
            return multiple reasons why a particular validation attempt failed.
        </p>
</div>
</div>
<br class="example-break"><div class="example">
<a name="zend.validator.writing_validators.example.conditions.independent"></a><p class="title"><b>Example 26.5. Validation with Independent Conditions, Multiple Reasons for Failure</b></p>
<div class="example-contents">
<p>
            Consider writing a validation class for password strength enforcement - when a user is
            required to choose a password that meets certain criteria for helping secure user
            accounts. Let us assume that the password security criteria enforce that the password:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>is at least 8 characters in length,</p></li>
<li class="listitem"><p>contains at least one uppercase letter,</p></li>
<li class="listitem"><p>contains at least one lowercase letter,</p></li>
<li class="listitem"><p>and contains at least one digit character.</p></li>
</ul></div>
<p>
            The following class implements these validation criteria:
        </p>
<pre class="programlisting">
class MyValid\PasswordStrength extends Zend\Validator\AbstractValidator
{
    const LENGTH = 'length';
    const UPPER  = 'upper';
    const LOWER  = 'lower';
    const DIGIT  = 'digit';

    protected $messageTemplates = array(
        self::LENGTH =&gt; "'%value%' must be at least 8 characters in length",
        self::UPPER  =&gt; "'%value%' must contain at least one uppercase letter",
        self::LOWER  =&gt; "'%value%' must contain at least one lowercase letter",
        self::DIGIT  =&gt; "'%value%' must contain at least one digit character"
    );

    public function isValid($value)
    {
        $this-&gt;setValue($value);

        $isValid = true;

        if (strlen($value) &lt; 8) {
            $this-&gt;error(self::LENGTH);
            $isValid = false;
        }

        if (!preg_match('/[A-Z]/', $value)) {
            $this-&gt;error(self::UPPER);
            $isValid = false;
        }

        if (!preg_match('/[a-z]/', $value)) {
            $this-&gt;error(self::LOWER);
            $isValid = false;
        }

        if (!preg_match('/\d/', $value)) {
            $this-&gt;error(self::DIGIT);
            $isValid = false;
        }

        return $isValid;
    }
}
</pre>
<p>
            Note that the four criteria tests in <code class="methodname">isValid()</code> do not
            immediately return <code class="constant">FALSE</code>. This allows the validation class to
            provide <span class="emphasis"><em>all</em></span> of the reasons that the input password failed to meet
            the validation requirements. if, for example, a user were to input the string "#$%" as a
            password, <code class="methodname">isValid()</code> would cause all four validation failure
            messages to be returned by a subsequent call to <code class="methodname">getMessages()</code>.
        </p>
</div>
</div>
<br class="example-break">
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.validator.validator_chains.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.validator.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.validator.messages.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">26.3. Validator Chains </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 26.5. Validation Messages</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
