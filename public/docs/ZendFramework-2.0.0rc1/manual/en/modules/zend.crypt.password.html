

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Password secure storing &mdash; Zend Framework 2 2.0.0beta5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0beta5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Zend Framework 2 2.0.0beta5 documentation" href="../index.html" />
    <link rel="next" title="Zend\Db\Adapter" href="zend.db.adapter.html" />
    <link rel="prev" title="Key derivation function" href="zend.crypt.key.derivation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="zend.db.adapter.html" title="Zend\Db\Adapter"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="zend.crypt.key.derivation.html" title="Key derivation function"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Zend Framework 2 2.0.0beta5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="password-secure-storing">
<span id="zend-crypt-password"></span><h1>Password secure storing<a class="headerlink" href="#password-secure-storing" title="Permalink to this headline">Â¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">Zend\Crypt\Password</span></tt> store a user&#8217;s password in a secure way using dedicated adapters like the <a class="reference external" href="http://en.wikipedia.org/wiki/Bcrypt">bcrypt</a>
algorithm.</p>
<p>In the example below we show hot to use the bcrypt algorithm to store a user&#8217;s password:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Zend\Crypt\Password\Bcrypt</span><span class="p">;</span>

<span class="nv">$bcrypt</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bcrypt</span><span class="p">()</span>
<span class="nv">$securePass</span> <span class="o">=</span> <span class="nv">$bcrypt</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;user password&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The output of the <tt class="docutils literal"><span class="pre">create()</span></tt> method is the encrypted password. This value can be stored in a repository, like a
database instead of use alternative mechanism like MD5 or MD5 + salt that are not considered secure anymore (<a class="reference external" href="http://codahale.com/how-to-safely-store-a-password/">read
this post to know why</a>).</p>
<p>To verify if a given password is valid against a bcrypt value you can use the <tt class="docutils literal"><span class="pre">verify()</span></tt> method. Below is
reported an example:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Zend\Crypt\Password\Bcrypt</span><span class="p">;</span>

<span class="nv">$bcrypt</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bcrypt</span><span class="p">();</span>
<span class="nv">$securePass</span> <span class="o">=</span> <span class="s1">&#39;the bcrypt value stored somewhere&#39;</span><span class="p">;</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="s1">&#39;the password to check&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$bcrypt</span><span class="o">-&gt;</span><span class="na">verify</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$bcrypt</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;The password is correct! </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;The password is NOT correct.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>By default the <tt class="docutils literal"><span class="pre">Zend\Crypt\Password\Bcrypt</span></tt> class uses a value of 14 for the cost parameter of the bcrypt. This
is an important value for the security of the bcrypt algorithm. The cost parameter is an integer value between 4 to
33. Greater values means more execution time for the bcrypt that means more security against brute force or
dictionary attacks. As for the PBKDF2 algorithm there is not a fixed value for that parameter that can be
considered secure. The default value of 14 is about 1 second of computation using an Intel Core i5-2500 CPU at 3.3
Ghz that can be considered secure.</p>
<p>If you want to change the cost parameter of the bcrypt algorithm you can use the <tt class="docutils literal"><span class="pre">setCost()</span></tt> method.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Bcrypt with non-ASCII passwords (8-bit characters)</strong></p>
<p class="last">The bcrypt implementation used by PHP &lt; 5.3.7 can contains a security flaw if the password uses 8-bit characters
(<a class="reference external" href="http://php.net/security/crypt_blowfish.php">here the security report</a>). The impact of this bug was that most (but not all) passwords containing non-ASCII
characters with the 8th bit set were hashed incorrectly, resulting in password hashes incompatible with those of
OpenBSD&#8217;s original implementation of bcrypt. This security flaw has been fixed starting from PHP 5.3.7 and the
prefix used in the output has changed in &#8216;$2y$&#8217; in order to put evidence on the correctness of the hash value.
If you are using PHP &lt; 5.3.7 with 8-bit passwords the <tt class="docutils literal"><span class="pre">Zend\Crypt\Password\Bcrypt</span></tt> throws an exception
suggesting to upgrade to PHP 5.3.7+ or use only 7-bit passwords.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/zf2_logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="zend.crypt.key.derivation.html"
                        title="previous chapter">Key derivation function</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="zend.db.adapter.html"
                        title="next chapter">Zend\Db\Adapter</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/modules/zend.crypt.password.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="zend.db.adapter.html" title="Zend\Db\Adapter"
             >next</a> |</li>
        <li class="right" >
          <a href="zend.crypt.key.derivation.html" title="Key derivation function"
             >previous</a> |</li>
        <li><a href="../index.html">Zend Framework 2 2.0.0beta5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Zend Technologies Ltd..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>