

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The PrefixPathLoader &mdash; Zend Framework 2 2.0.0rc6 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0rc6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Zend Framework 2 2.0.0rc6 documentation" href="../index.html" />
    <link rel="next" title="The PrefixPathMapper Interface" href="zend.loader.prefix-path-mapper.html" />
    <link rel="prev" title="The Class Map Generator utility: bin/classmap_generator.php" href="zend.loader.classmap-generator.html" />
<style type="text/css">
    /* Styles for floating Edit on GitHub box */
    #editor-trap {
        padding: 1em;
        border: 1px solid white;
        width: 250px;

        display: none;
        color: white;
        background: #3f454b;
        position: fixed;
        bottom: 5px;
        left: 175px;
        font-size: 85%;
        text-align: left;
        z-index: 2;

        box-shadow: 0 4px 6px #333;
        -moz-box-shadow: 0 4px 6px #333;
        -webkit-box-shadow: 0 4px 6px #333;
        
        cursor: pointer;
    }

    #editor-trap h3 {
        margin: 0 0 0.5em 0;
        padding: 0;
    }

    #editor-trap h3 > span {
        padding: 0 6px;
        border: solid white;
        border-width: 0 1px 4px 1px;
        font-size: 10px;
    }

    #editor-trap a {
        color: #98DBCC;
    }

    #editor-trap ol {
        margin: 0;
        padding: 0 0 0 2em;
    }

    /* Hide trick */
    #editor-trap.toggled > * {
        display: none;
    }


    #editor-trap.toggled > h3 {
        display: block;
    }

    #editor-trap.toggled > h3 > span {
        border-width: 6px 1px 0 1px;
    }
    
    #edit-button {
        position: fixed;
        bottom: 5px;
        left: 5px;
        z-index: 2;
        width: 162px;
        height: 42px;
    }
</style>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="zend.loader.prefix-path-mapper.html" title="The PrefixPathMapper Interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="zend.loader.classmap-generator.html" title="The Class Map Generator utility: bin/classmap_generator.php"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Zend Framework 2 2.0.0rc6 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-prefixpathloader">
<span id="zend-loader-prefix-path-loader"></span><h1>The PrefixPathLoader<a class="headerlink" href="#the-prefixpathloader" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="zend-loader-prefix-path-loader-intro"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Zend Framework&#8217;s 1.X series introduced a plugin methodology surrounding associations of vendor/component prefixes
and filesystem paths in the <tt class="docutils literal"><span class="pre">Zend_Loader_PluginLoader</span></tt> class. Zend Framework 2 provides equivalent functionality
with the <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> class, and expands it to take advantage of PHP 5.3 namespaces.</p>
<p>The concept is relatively simple: a given vendor prefix or namespace is mapped to one or more paths, and multiple
prefix/path maps may be provided. To resolve a plugin name, the prefixes are searched as a stack (i.e., last in,
first out, or LIFO), and each path associated with the prefix is also searched as a stack. As soon as a file is
found matching the plugin name, the class will be returned.</p>
<p>Since searching through the filesystem can lead to performance degradation, the <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> provides
several optimizations. First, it will attempt to autoload a plugin before scanning the filesystem. This allows you
to benefit from your autoloader and/or an opcode cache. Second, it aggregates the class name and class file
associated with each discovered plugin. You can then retrieve this information and cache it for later seeding a
<a class="reference internal" href="zend.loader.class-map-autoloader.html#zend-loader-class-map-autoloader"><em>ClassMapAutoloader</em></a> and <a class="reference internal" href="zend.loader.plugin-class-loader.html#zend-loader-plugin-class-loader"><em>PluginClassLoader</em></a>.</p>
<p><tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> implements the <tt class="docutils literal"><span class="pre">ShortNameLocator</span></tt> and <tt class="docutils literal"><span class="pre">PrefixPathMapper</span></tt> interfaces.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Case Sensitivity</strong></p>
<p class="last">Unlike the <a class="reference internal" href="zend.loader.plugin-class-loader.html#zend-loader-plugin-class-loader"><em>PluginClassLoader</em></a>, plugins resolved via the
<tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> are considered case sensitive. This is due to the fact that the lookup is done on the
filesystem, and thus a file exactly matching the plugin name must exist.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Preference is for Namespaces</strong></p>
<p class="last">Unlike the Zend Framework 1 variant, the <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> assumes that &#8220;prefixes&#8221; are PHP 5.3 namespaces by
default. You can override this behavior, however, per prefix/path you map. Please see the documentation and
examples below for details.</p>
</div>
</div>
<div class="section" id="quick-start">
<span id="zend-loader-prefix-path-loader-quick-start"></span><h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> invariably requires some configuration &#8211; it needs to know what namespaces and/or vendor
prefixes it should try, as well as the paths associated with each. You can inform the class of these at
instantiation, or later by calling either the <tt class="docutils literal"><span class="pre">addPrefixPath()</span></tt> or <tt class="docutils literal"><span class="pre">addPrefixPaths()</span></tt> methods.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Zend\Loader\PrefixPathLoader</span><span class="p">;</span>

<span class="c1">// Configure at instantiation:</span>
<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrefixPathLoader</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;../library/Foo&#39;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;../vendor/Bar&#39;</span><span class="p">),</span>
<span class="p">));</span>

<span class="c1">// Or configure manually using methods:</span>
<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrefixPathLoader</span><span class="p">();</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPrefixPath</span><span class="p">(</span><span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;../library/Foo&#39;</span><span class="p">);</span>

<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPrefixPaths</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;../library/Foo&#39;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;../vendor/Bar&#39;</span><span class="p">),</span>
<span class="p">));</span>
</pre></div>
</td></tr></table></div>
<p>Once configured, you may then attempt to lookup a plugin.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="k">false</span> <span class="o">===</span> <span class="p">(</span><span class="nv">$class</span> <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)))</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s2">&quot;Plugin class matching &#39;bar&#39; not found!&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nv">$plugin</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$class</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="configuration-options">
<span id="zend-loader-prefix-path-loader-options"></span><h2>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p class="rubric">PrefixPathLoader Options</p>
<dl class="docutils">
<dt><strong>$options</strong></dt>
<dd>The constructor accepts either an array or a <tt class="docutils literal"><span class="pre">Traversable</span></tt> object of prefix paths. For the format allowed,
please see the <a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-paths"><em>addPrefixPaths()</em></a> method
documentation.</dd>
</dl>
</div>
<div class="section" id="available-methods">
<span id="zend-loader-prefix-path-loader-methods"></span><h2>Available Methods<a class="headerlink" href="#available-methods" title="Permalink to this headline">¶</a></h2>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-constructor">
<dt>__construct</dt>
<dd><p class="first">Instantiate and initialize loader
<tt class="docutils literal"><span class="pre">__construct($options</span> <span class="pre">=</span> <span class="pre">null)</span></tt></p>
<p class="last"><strong>__construct()</strong>
Instantiates and initializes a <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> instance. If the <tt class="docutils literal"><span class="pre">$prefixPaths</span></tt> protected member is
defined, it re-initializes it to an <tt class="docutils literal"><span class="pre">Zend\Stdlib\ArrayStack</span></tt> instance, and passes the original value to
<a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-paths"><em>the addPrefixPaths() method</em></a>. It then checks to
see if <tt class="docutils literal"><span class="pre">$staticPaths</span></tt> has been populated, and, if so, passes that on to the <tt class="docutils literal"><span class="pre">addPrefixPaths()</span></tt> method to
merge the values. Finally, if <tt class="docutils literal"><span class="pre">$options</span></tt> is non-null, it passes that to <tt class="docutils literal"><span class="pre">addPrefixPaths()</span></tt>.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-add-static-paths">
<dt>addStaticPaths</dt>
<dd><p class="first">Add paths statically
<tt class="docutils literal"><span class="pre">addStaticPaths($paths)</span></tt></p>
<p class="last"><strong>addStaticPaths()</strong>
Expects an array or <tt class="docutils literal"><span class="pre">Traversable</span></tt> object compatible with the <tt class="docutils literal"><span class="pre">addPrefixPaths()</span></tt> method. This method is
static, and populates the protected <tt class="docutils literal"><span class="pre">$staticPaths</span></tt> member, which is used during instantiation to either
override default paths or add additional prefix/path pairs to search.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-set-options">
<dt>setOptions</dt>
<dd><p class="first">Configure object state
<tt class="docutils literal"><span class="pre">setOptions($options)</span></tt></p>
<p class="last"><strong>setOptions()</strong>
Proxies to <a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-paths"><em>addPrefixPaths()</em></a>.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-add-prefix-path">
<dt>addPrefixPath</dt>
<dd><p class="first">Map a namespace/vendor prefix to the given filesystem path
<tt class="docutils literal"><span class="pre">addPrefixPath($prefix,</span> <span class="pre">$path,</span> <span class="pre">$namespaced</span> <span class="pre">=</span> <span class="pre">true)</span></tt></p>
<p><strong>addPrefixPath()</strong>
Use this method to map a single filesystem path to a given namespace or vendor prefix. By default, the
<tt class="docutils literal"><span class="pre">$prefix</span></tt> will be considered a PHP 5.3 namespace; you may specify that it is a vendor prefix by passing a
boolean <tt class="docutils literal"><span class="pre">false</span></tt> value to the <tt class="docutils literal"><span class="pre">$namespaced</span></tt> argument.</p>
<p class="last">If the <tt class="docutils literal"><span class="pre">$prefix</span></tt> has been previously mapped, this method adds another <tt class="docutils literal"><span class="pre">$path</span></tt> to a stack &#8211; meaning the new
path will be searched first when attempting to resolve a plugin name to this <tt class="docutils literal"><span class="pre">$prefix</span></tt>.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-add-prefix-paths">
<dt>addPrefixPaths</dt>
<dd><p class="first">Add many prefix/path pairs at once
<tt class="docutils literal"><span class="pre">addPrefixPaths($prefixPaths)</span></tt></p>
<p><strong>addPrefixPaths()</strong>
This method expects an array or <tt class="docutils literal"><span class="pre">Traversable</span></tt> object. Each item in the array or object must be one of the
following:</p>
<ul class="simple">
<li>An array, with the keys &#8220;prefix&#8221; and &#8220;path&#8221;, and optionally &#8220;namespaced&#8221;; the keys correspond to the arguments
to <a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-path"><em>addPrefixPath()</em></a>. The &#8220;prefix&#8221; and &#8220;path&#8221;
keys should point to string values, while the &#8220;namespaced&#8221; key should be a boolean.</li>
<li>An object, with the attributes &#8220;prefix&#8221; and &#8220;path&#8221;, and optionally &#8220;namespaced&#8221;; the attributes correspond to
the arguments to <a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-path"><em>addPrefixPath()</em></a>. The &#8220;prefix&#8221;
and &#8220;path&#8221; attributes should point to string values, while the &#8220;namespaced&#8221; attribute should be a boolean.</li>
</ul>
<p class="last">The method will loop over arguments, and pass values to <a class="reference internal" href="#zend-loader-prefix-path-loader-methods-add-prefix-path"><em>addPrefixPath()</em></a> to process.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-get-paths">
<dt>getPaths</dt>
<dd><p class="first">Retrieve all paths associated with a prefix, or all paths
<tt class="docutils literal"><span class="pre">getPaths($prefix</span> <span class="pre">=</span> <span class="pre">null)</span></tt></p>
<p><strong>getPaths()</strong>
Use this method to obtain the prefix/paths map. If no <tt class="docutils literal"><span class="pre">$prefix</span></tt> is provided, the return value is an
<tt class="docutils literal"><span class="pre">Zend\Stdlib\ArrayStack</span></tt>, where the keys are namespaces or vendor prefixes, and the values are
<tt class="docutils literal"><span class="pre">Zend\Stdlib\SplStack</span></tt> instances containing all paths associated with the given namespace or prefix.</p>
<p class="last">If the <tt class="docutils literal"><span class="pre">$prefix</span></tt> argument is provided, two outcomes are possible. If the prefix is not found, a boolean
<tt class="docutils literal"><span class="pre">false</span></tt> value is returned. If the prefix is found, a <tt class="docutils literal"><span class="pre">Zend\Stdlib\SplStack</span></tt> instance containing all paths
associated with that prefix is returned.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-clear-paths">
<dt>clearPaths</dt>
<dd><p class="first">Clear all maps, or all paths for a given prefix
<tt class="docutils literal"><span class="pre">clearPaths($prefix</span> <span class="pre">=</span> <span class="pre">null)</span></tt></p>
<p class="last"><strong>clearPaths()</strong>
If no <tt class="docutils literal"><span class="pre">$prefix</span></tt> is provided, all prefix/path pairs are removed. If a <tt class="docutils literal"><span class="pre">$prefix</span></tt> is provided and found within
the map, only that prefix is removed. Finally, if a <tt class="docutils literal"><span class="pre">$prefix</span></tt> is provided, but not found, a boolean <tt class="docutils literal"><span class="pre">false</span></tt>
is returned.</p>
</dd>
</dl>
<p id="zend-loader-prefix-path-loader-methods-remove-prefix-path">removePrefixPath</p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">removePrefixPath($prefix,</span> <span class="pre">$path)</span></tt></p>
<p><strong>removePrefixPath()</strong>
Removes a single path from a given prefix.</p>
</div></blockquote>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-is-loaded">
<dt>isLoaded</dt>
<dd><p class="first">Has the given plugin been loaded?
<tt class="docutils literal"><span class="pre">isLoaded($name)</span></tt></p>
<p class="last"><strong>isLoaded()</strong>
Use this method to determine if the given plugin has been resolved to a class and file. Unlike
<tt class="docutils literal"><span class="pre">PluginClassLoader</span></tt>, this method can return a boolean <tt class="docutils literal"><span class="pre">false</span></tt> even if the loader is capable of loading the
plugin; it simply indicates whether or not the current instance has yet resolved the plugin via the <tt class="docutils literal"><span class="pre">load()</span></tt>
method.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-get-class-name">
<dt>getClassName</dt>
<dd><p class="first">Retrieve the class name to which a plugin resolves
<tt class="docutils literal"><span class="pre">getClassName($name)</span></tt></p>
<p class="last"><strong>getClassName()</strong>
Given a plugin name, this method will attempt to return the associated class name. The method completes
successfully if, and only if, the plugin has been successfully loaded via <tt class="docutils literal"><span class="pre">load()</span></tt>. Otherwise, it will return
a boolean <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-load">
<dt>load</dt>
<dd><p class="first">Attempt to resolve a plugin to a class
<tt class="docutils literal"><span class="pre">load($name)</span></tt></p>
<p><strong>load()</strong>
Given a plugin name, the <tt class="docutils literal"><span class="pre">load()</span></tt> method will loop through the internal <tt class="docutils literal"><span class="pre">ArrayStack</span></tt>. The plugin name is
first normalized using <tt class="docutils literal"><span class="pre">ucwords()</span></tt>, and then appended to the current vendor prefix or namespace. If the
resulting class name resolves via autoloading, the class name is immediately returned. Otherwise, it then loops
through the associated <tt class="docutils literal"><span class="pre">SplStack</span></tt> of paths for the prefix, looking for a file matching the plugin name (i.e.,
for plugin <tt class="docutils literal"><span class="pre">Foo</span></tt>, file name <tt class="docutils literal"><span class="pre">Foo.php</span></tt>) in the given path. If a match is found, the class name is returned.</p>
<p class="last">If no match is found, a boolean false is returned.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-get-plugin-map">
<dt>getPluginMap</dt>
<dd><p class="first">Get a list of plugin/class name pairs
<tt class="docutils literal"><span class="pre">getPluginMap()</span></tt></p>
<p class="last"><strong>getPluginMap()</strong>
Returns an array of resolved plugin name/class name pairs. This value may be used to seed a
<tt class="docutils literal"><span class="pre">PluginClassLoader</span></tt> instance.</p>
</dd>
</dl>
<dl class="docutils" id="zend-loader-prefix-path-loader-methods-get-class-map">
<dt>getClassMap</dt>
<dd><p class="first">Get a list of class name/file name pairs
<tt class="docutils literal"><span class="pre">getClassMap()</span></tt></p>
<p class="last"><strong>getClassMap()</strong>
Returns an array of resolved class name/file name pairs. This value may be used to seed a <tt class="docutils literal"><span class="pre">ClassMapAutoloader</span></tt>
instance.</p>
</dd>
</dl>
</div>
<div class="section" id="examples">
<span id="zend-loader-prefix-path-loader-examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p class="rubric" id="zend-loader-prefix-path-loader-examples-multiple-paths">Using multiple paths for the same prefix</p>
<p>Sometimes you may have code containing the same namespace or vendor prefix in two different locations. Potentially,
the same class may be defined in different locations, but with slightly different functionality. (We do not
recommend this, but sometimes it happens.)</p>
<p>The <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> easily allows for these situations; simply register the path you want to take precedence
last.</p>
<p>Consider the following directory structures:</p>
<div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre>project
|-- library
|   |-- Foo
|   |   |-- Bar.php
|   |   `-- Baz.php
|-- vendor
|   |-- Foo
|   |   |-- Bar.php
|   |   `-- Foobar.php
</pre></div>
</td></tr></table></div>
<p>For purposes of this example, we&#8217;ll assume that the common namespace is &#8220;Foo&#8221;, and that the &#8220;Bar&#8221; plugin from the
vendor branch is preferred. To make this possible, simply register the &#8220;vendor&#8221; directory last.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Zend\Loader\PrefixPathLoader</span><span class="p">;</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrefixPathLoader</span><span class="p">();</span>

<span class="c1">// Multiple calls to addPrefixPath():</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPrefixPath</span><span class="p">(</span><span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="nx">PROJECT_ROOT</span> <span class="o">.</span> <span class="s1">&#39;/library/Foo&#39;</span><span class="p">)</span>
       <span class="o">-&gt;</span><span class="na">addPrefixPath</span><span class="p">(</span><span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="nx">PROJECT_ROOT</span> <span class="o">.</span> <span class="s1">&#39;/vendor/Foo&#39;</span><span class="p">);</span>

<span class="c1">// Or use a single call to addPrefixPaths():</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">addPrefixPaths</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nx">PROJECT_ROOT</span> <span class="o">.</span> <span class="s1">&#39;/library/Foo&#39;</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span> <span class="o">=&gt;</span> <span class="nx">PROJECT_ROOT</span> <span class="o">.</span> <span class="s1">&#39;/vendor/Foo&#39;</span><span class="p">),</span>
<span class="p">));</span>

<span class="c1">// And then resolve plugins:</span>
<span class="nv">$bar</span>    <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>    <span class="c1">// Foo\Bar from vendor/Foo/Bar.php</span>
<span class="nv">$baz</span>    <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;baz&#39;</span><span class="p">);</span>    <span class="c1">// Foo\Baz from library/Foo/Baz.php</span>
<span class="nv">$foobar</span> <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">);</span> <span class="c1">// Foo\Foobar from vendor/Foo/Baz.php</span>
</pre></div>
</td></tr></table></div>
<p class="rubric" id="zend-loader-prefix-path-loader-examples-optimizing">Prototyping with PrefixPathLoader</p>
<p><tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> is quite useful for prototyping applications. With minimal configuration, you can access a
full directory of plugins, without needing to update maps as new plugins are added. However, this comes with a
price: performance. Since plugins are resolved typically using by searching the filesystem, you are introducing I/O
calls every time you request a new plugin.</p>
<p>With this in mind, <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt> provides two methods for assisting in migrating to more performant
solutions. The first is <tt class="docutils literal"><span class="pre">getClassMap()</span></tt>. This method returns an array of class name/file name pairs suitable for
use with <a class="reference internal" href="zend.loader.class-map-autoloader.html#zend-loader-class-map-autoloader"><em>ClassMapAutoloader</em></a>. Injecting your autoloader with that map will
ensure that on subsequent calls, <tt class="docutils literal"><span class="pre">load()</span></tt> should be able to find the appropriate class via autoloading &#8211;
assuming that the match is on the first prefix checked.</p>
<p>The second solution is the <tt class="docutils literal"><span class="pre">getPluginMap()</span></tt> method, which creates a plugin name/class name map suitable for
injecting into a <a class="reference internal" href="zend.loader.plugin-class-loader.html#zend-loader-plugin-class-loader"><em>PluginClassLoader</em></a> instance. Combine this with class
map-based autoloading, and you can actually eliminate I/O calls altogether when using an opcode cache.</p>
<p>Usage of these methods is quite simple.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// After a number of load() operations, or at the end of the request:</span>
<span class="nv">$classMap</span>  <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">getClassMap</span><span class="p">();</span>
<span class="nv">$pluginMap</span> <span class="o">=</span> <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">getPluginMap</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p>From here, you will need to do a little work. First, you need to serialize this information somehow for later use.
For that, there are two options: <tt class="docutils literal"><span class="pre">Zend\Serializer</span></tt> or <tt class="docutils literal"><span class="pre">Zend\Cache</span></tt>.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">// Using Zend\Serializer:</span>
<span class="k">use</span> <span class="nx">Zend\Serializer\Serializer</span><span class="p">;</span>

<span class="nv">$adapter</span> <span class="o">=</span> <span class="nx">Serializer</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">&#39;PhpCode&#39;</span><span class="p">);</span>
<span class="nv">$content</span> <span class="o">=</span> <span class="s2">&quot;&lt;?php</span><span class="se">\n</span><span class="s2">return &quot;</span> <span class="o">.</span> <span class="nv">$adapter</span><span class="o">-&gt;</span><span class="na">serialize</span><span class="p">(</span><span class="nv">$classMap</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span>
<span class="nb">file_put_contents</span><span class="p">(</span><span class="nx">APPLICATION_PATH</span> <span class="o">.</span> <span class="s1">&#39;/.classmap.php&#39;</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>

<span class="c1">// Using Zend\Cache:</span>
<span class="k">use</span> <span class="nx">Zend\Cache\Cache</span><span class="p">;</span>

<span class="nv">$cache</span> <span class="o">=</span> <span class="nx">Cache</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span>
    <span class="s1">&#39;Core&#39;</span><span class="p">,</span> <span class="s1">&#39;File&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;lifetime&#39;</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">,</span> <span class="s1">&#39;automatic_serialization&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">),</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;cache_dir&#39;</span> <span class="o">=&gt;</span> <span class="nx">APPLICATION_PATH</span> <span class="o">.</span> <span class="s1">&#39;/../cache/classmaps&#39;</span><span class="p">)</span>
<span class="p">);</span>
<span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$pluginMap</span><span class="p">,</span> <span class="s1">&#39;pluginmap&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>Note: the examples alternate between the class map and plugin map; however, either technique applies to either map.</p>
<p>Once the data is cached, you can retrieve it late to populate. In the example of the class map above, you would
simply pass the filename to the <tt class="docutils literal"><span class="pre">ClassMapAutoloader</span></tt> instance:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">$autoloader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend\Loader\ClassMapAutoloader</span><span class="p">();</span>
<span class="nv">$autoloader</span><span class="o">-&gt;</span><span class="na">registerAutoloadMap</span><span class="p">(</span><span class="nx">APPLICATION_PATH</span> <span class="o">.</span> <span class="s1">&#39;/.classmap.php&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>If using <tt class="docutils literal"><span class="pre">Zend\Cache</span></tt>, you would retrieve the cached data, and pass it to the appropriate component; in this
case, we pass the value to a <tt class="docutils literal"><span class="pre">PluginClassLoader</span></tt> instance.</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="nv">$map</span> <span class="o">=</span> <span class="nv">$cache</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;pluginmap&#39;</span><span class="p">);</span>

<span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Zend\Loader\PluginClassLoader</span><span class="p">(</span><span class="nv">$map</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>With some creative and well disciplined architecture, you can likely automate these processes to ensure that
development can benefit from the dynamic nature of the <tt class="docutils literal"><span class="pre">PrefixPathLoader</span></tt>, and production can benefit from the
performance optimizations of the <tt class="docutils literal"><span class="pre">ClassMapAutoloader</span></tt> and <tt class="docutils literal"><span class="pre">PluginClassLoader</span></tt>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/zf2_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The PrefixPathLoader</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li><a class="reference internal" href="#configuration-options">Configuration Options</a></li>
<li><a class="reference internal" href="#available-methods">Available Methods</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="zend.loader.classmap-generator.html"
                        title="previous chapter">The Class Map Generator utility: bin/classmap_generator.php</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="zend.loader.prefix-path-mapper.html"
                        title="next chapter">The PrefixPathMapper Interface</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li>
        <!--<a href="../_sources/modules/zend.loader.prefix-path-loader.txt"-->
        <a href="https://github.com/zendframework/zf2-documentation/blob/master/docs/languages/en/modules/zend.loader.prefix-path-loader.rst"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/zendframework/zf2-documentation/edit/master/docs/languages/en/modules/zend.loader.prefix-path-loader.rst"
           rel="nofollow">Edit Source</a>
    </li>
  </ul>
        <p style="font-size: 12px">
            Note: You need to stay logged into your <a href="http://www.github.com">GitHub account</a> to contribute to the documentation.
        </p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="zend.loader.prefix-path-mapper.html" title="The PrefixPathMapper Interface"
             >next</a> |</li>
        <li class="right" >
          <a href="zend.loader.classmap-generator.html" title="The Class Map Generator utility: bin/classmap_generator.php"
             >previous</a> |</li>
        <li><a href="../index.html">Zend Framework 2 2.0.0rc6 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2012, Zend Technologies Ltd..
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<div id="edit-button">
    <img src="../_static/edit.gif" alt="Edit this document" title="Edit this document" onclick="javascript:$('#editor-trap').toggle();">
</div>
     
<div id="editor-trap">
    <h3>Edit this document</h3>

    <p>
        The source code of this file is hosted on GitHub. Everyone can
        update and fix errors in this document with few clicks -
        no downloads needed.
    <p>

    <ol>

        <li>
            Login with your <a href="http://www.github.com">GitHub</a> account.
        </li>

        <li>
            Go to
            <a href="https://github.com/zendframework/zf2-documentation/edit/master/docs/languages/en/modules/zend.loader.prefix-path-loader.rst">
                The PrefixPathLoader
            </a> on GitHub.
        </li>

        <li>
            Edit file contents using GitHub's text editor in your web browser
        </li>

        <li>
            Fill in the <b>Commit message</b> text box at the end of the page telling <i>why</i>
            you did the changes. Press <b>Propose file change</b> button next to it when done.
        </li>


        <li>
            On <i>Send a pull request</i> page you don't need to fill in text anymore. Just
            press <b>Send pull request</b> button.
        </li>

        <li>
            Your changes are now queued for review under project's <a href="https://github.com/zendframework/zf2-documentation/pulls">Pull requests</a> tab on GitHub.
        </li>
    </ol>

</div>


  </body>
</html>